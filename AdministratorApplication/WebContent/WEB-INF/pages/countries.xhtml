<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core">
<h:head />
<h:body>
	<ui:composition template="/WEB-INF/templates/template.xhtml">
		<ui:define name="header">
			<ui:include src="/WEB-INF/components/header.xhtml" />
		</ui:define>
		<ui:define name="navmenu">
			<ui:include src="/WEB-INF/components/navmenu.xhtml" />
		</ui:define>
		<ui:define name="body">
			<div class="container-fluid --main-table-container">
				<div class="row">
					<div class='col-12'>
						<table class="table table-sm --main-table">
							<thead>
								<tr>
									<th scope="col">Name</th>
									<th scope="col">Cities</th>
									<th scope="col">Actions</th>
								</tr>
							</thead>
							<tbody>
								<c:forEach
									items="${flightReservationsBean.getFlightReservations()}"
									var="item">
									<tr>
										<td>${item.getDepartureCountryName()}</td>
										<td>${item.getDepartureCityName()}</td>
										<td>${item.getArrivalCountryName()}</td>
										<td>${item.getArrivalCityName()}</td> <%
										if((AccountRole)request.getAttribute("accountRole")==AccountRole.Passenger)
										{%>
										<td>${item.getSeatNumber()}</td> <%} else { %>
										<td>${item.getCargoDescription()}</td>
										<c:url var="downloadFile" value="FlightReservationController">
											<c:param name="file"
												value="${item.getFileSpecificationName()}" />
											<c:param name="action" value="download" />
										</c:url>
										<td><button class='btn btn-secondary'>
												<a href="${downloadFile}">Download</a>
											</button></td> <% } %>
										<td>${item.getDepartureOn()}</td>
										<td>${item.getArrivalOn()}</td>
										<td>${item.getCreatedOn()}</td>
										<td>${item.getStatus()}</td>
										<c:choose>
											<c:when
												test="${item.getStatus()==FlightReservationStatus.New}">
												<c:url var="changeStatus"
													value="FlightReservationController">
													<c:param name="status" value="Canceled" />
													<c:param name="action" value="change" />
													<c:param name="flightReservationId"
														value="${item.getFlightReservationId()}" />
												</c:url>
												<td><button class='btn btn-danger'>
														<a href="${changeStatus}"> Cancel </a>
													</button></td>
											</c:when>
											<c:when
												test="${item.getStatus()!=FlightReservationStatus.New}">
												<td><button class='btn btn-danger' disabled>Cancel</button>
												</td>
											</c:when>
										</c:choose>
									</tr>
								</c:forEach>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</ui:define>
		<ui:define name="footer">
			<ui:include src="/WEB-INF/components/footer.xhtml" />
		</ui:define>
	</ui:composition>
</h:body>
</html>